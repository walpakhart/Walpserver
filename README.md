# walpakhart.co - Файловый сервер с заметками и фильмами

Полнофункциональный самостоятельно хостируемый файловый сервер с современным веб-интерфейсом для загрузки, просмотра и управления файлами, заметками и фильмами. Проект включает поддержку категоризации файлов, заметок, личной коллекции фильмов, систему авторизации и адаптивный дизайн с темным режимом.

## Основные возможности

- **Управление файлами:** загрузка, просмотр и скачивание файлов различных типов
- **Встроенный медиаплеер:** воспроизведение аудио и видео файлов непосредственно в браузере
- **Хранение ссылок:** сохранение и управление ссылками на внешние ресурсы
- **Заметки:** создание и управление личными заметками с разными приоритетами
- **Коллекция фильмов:** поиск и сохранение фильмов с использованием API Кинопоиска
- **Категоризация:** автоматическое распределение файлов по категориям (изображения, видео, аудио, документы, скрипты и т.д.)
- **Загрузка папок:** поддержка загрузки целых папок с сохранением их структуры
- **Предпросмотр файлов:** просмотр содержимого текстовых файлов, изображений и PDF непосредственно в браузере
- **Сортировка и поиск:** удобный поиск и сортировка по имени, дате и размеру
- **Безопасность:** система авторизации с защитой паролей
- **Адаптивный дизайн:** работает на всех устройствах, включая мобильные
- **Темный режим:** автоматическое переключение в зависимости от системных настроек
- **Интернационализация:** поддержка русского и английского языков, возможность переключения между ними

## Новые возможности в последнем обновлении

- **Встроенный медиаплеер:** воспроизведение видео и аудио файлов прямо в браузере без необходимости скачивания
- **Улучшенная организация кода:** добавлен .gitignore файл для правильного контроля версий
- **Улучшенная документация:** обновленный README.md с подробной информацией о возможностях

## Системные требования

- **Python**: 3.8 или выше
- **Зависимости**: Flask, Flask-Login, BeautifulSoup4, Requests, lxml, Gunicorn
- **Веб-сервер**: Nginx
- **Дисковое пространство**: минимум 100 МБ для приложения (без учета загружаемых файлов)
- **Оперативная память**: минимум 256 МБ, рекомендуется 512 МБ и больше

## Быстрая настройка на Linux (одноразовая установка)

### 1. Подготовка системы

```bash
# Обновление системы
sudo apt update && sudo apt upgrade -y

# Установка необходимых пакетов
sudo apt install -y python3 python3-pip python3-venv git ngrok
```

### 2. Установка файлового сервера

```bash
# Клонирование репозитория
git clone https://github.com/yourusername/selfhosted-file-server.git
cd selfhosted-file-server

# Создание виртуального окружения
python3 -m venv venv
source venv/bin/activate

# Установка зависимостей
pip install -r requirements.txt

# Копирование и настройка конфигурации
cp config.example.py config.py
# Отредактируйте config.py, установите SECRET_KEY и другие параметры
```

### 3. Настройка Ngrok 

Для использования постоянного домена с ngrok, выполните следующие шаги:

1. **Получите платный план ngrok**: Зарегистрируйтесь на сайте ngrok и выберите подходящий платный план, который позволяет использовать пользовательские домены.

2. **Установите authtoken**: После получения платного плана, вам будет предоставлен `authtoken`. Установите его, выполнив следующую команду в терминале:

   ```bash
   ngrok config add-authtoken 2ttL0rDpz2TUmBI8u7MZ6WvNQra_4zuy2qNPcftUwRKwwy17G

ngrok http --url=bengal-coherent-strictly.ngrok-free.app 5000
   ```

3. **Зарезервируйте доменное имя**: После установки `authtoken`, вы можете зарезервировать доменное имя и использовать его с помощью аргумента `-subdomain`. Запустите ngrok с помощью следующей команды:

   ```bash
   ngrok http -host-header="localhost:58821" -subdomain my-cool-app 58821
   ```

   Здесь `my-cool-app` — это ваш пользовательский поддомен, а `58821` — это порт, который вы хотите пробросить через ngrok.

4. **Используйте постоянный URL**: Теперь вы можете использовать `https://my-cool-app.ngrok.io` для постоянного доступа к вашему окружению разработки.

## Структура проекта

```
selfhosted-file-server/
├── server.py           # Основной файл приложения Flask
├── config.py           # Файл конфигурации
├── config.example.py   # Пример файла конфигурации
├── requirements.txt    # Список зависимостей Python
├── .gitignore          # Файл для игнорирования файлов в Git
├── README.md           # Документация проекта
├── users.db            # База данных SQLite
├── uploads/            # Директория для загруженных файлов
├── downloads/          # Директория для скачанных файлов
├── static/             # Статические файлы
|   ├── css/            # CSS стили
|   ├── js/             # JavaScript файлы
|   |   └── modules/    # Модули JavaScript
|   └── img/            # Изображения
└── templates/          # HTML шаблоны
```

## Поддержка воспроизведения медиафайлов

С последним обновлением добавлена поддержка воспроизведения аудио и видео прямо в браузере. Поддерживаются следующие форматы:

- **Видео:** MP4, WebM, OGG, MOV, AVI, MKV
- **Аудио:** MP3, WAV, OGG, FLAC, M4A

Для воспроизведения медиафайла просто нажмите кнопку воспроизведения (значок Play) на карточке соответствующего файла.

## Зависимости

Flask==2.3.3
Flask-Login==0.6.2
Werkzeug==2.3.7
gunicorn==21.2.0
python-dotenv==1.0.0
requests==2.31.0
beautifulsoup4==4.12.2
lxml==4.9.3

## Лицензия

Этот проект распространяется под лицензией MIT.
